;/*FB_PKG_DELIM*/

__d("LSUpdateChannelsFolderEligibleTag",[],(function(a,b,c,d,e,f){function a(){var a=arguments,b=a[a.length-1],c=[];return b.sequence([function(c){return b.db.table(9).fetch([[[a[0]]]]).next().then(function(c,d){d=c.done;c=c.value;return d?0:(c.item,b.forEach(b.db.table(9).fetch([[[a[0]]]]),function(a){var c=a.update;a=a.item;return c({threadTags:b.i64.or_(a.threadTags==null?b.i64.cast([0,0]):a.threadTags,b.i64.cast([0,65536]))})}))})},function(a){return b.resolve(c)}])}a.__sproc_name__="LSMailboxUpdateChannelsFolderEligibleTagStoredProcedure";a.__tables__=["threads"];e.exports=a}),null);
__d("LSUpdateCommunityContainerReadWatermarkAndSnipet",["LSGetParentThreadKey","LSMarkFolderSeen","LSUpdateFolderThreadSnippet"],(function(a,b,c,d,e,f){function a(){var a=arguments,c=a[a.length-1],d=[],e=[];return c.sequence([function(e){return c.sequence([function(e){return c.storedProcedure(b("LSGetParentThreadKey"),a[0]).then(function(a){return a=a,d[0]=a[0],a})},function(e){return c.i64.neq(d[0],c.i64.cast([0,0]))?c.sequence([function(b){return c.count(c.filter(c.db.table(9).fetch([[[{lt:a[0]}],[{gt:a[0]}]]]),function(b){return c.i64.neq(b.threadKey,a[0])&&c.i64.eq(b.parentThreadKey,d[0])&&c.i64.lt(b.lastReadWatermarkTimestampMs,b.lastActivityTimestampMs)})).then(function(a){return d[1]=a})},function(a){return c.i64.eq(d[1],c.i64.cast([0,0]))?c.storedProcedure(b("LSMarkFolderSeen"),d[0]):c.resolve()},function(e){return c.storedProcedure(b("LSUpdateFolderThreadSnippet"),d[0],void 0,a[2])}]):c.resolve()}])},function(a){return c.resolve(e)}])}a.__sproc_name__="LSMailboxUpdateCommunityContainerReadWatermarkAndSnipetStoredProcedure";a.__tables__=["threads"];e.exports=a}),null);